/*
   1. Let's see our volume growth by finding the overall session and order volume, trended by quarter for the life of the business.
*/

SELECT YEAR(website_sessions.created_at) AS yr,
       QUARTER(website_sessions.created_at) AS qtr,
       COUNT(DISTINCT website_sessions.website_session_id) AS sessions,
       COUNT(DISTINCT orders.order_id) AS orders       
FROM website_sessions
     LEFT JOIN orders
        ON website_sessions.website_session_id = orders.website_session_id
GROUP BY 1,2
ORDER BY 1,2




/*
   2. To confirm our efficiency improvements, let's find the quarterly figures!
      For session-to-order conversion rate, revenue per order, and revenue per session.
*/

SELECT YEAR(website_sessions.created_at) AS yr,
       QUARTER(website_sessions.created_at) AS qtr,
       COUNT(DISTINCT orders.order_id)/COUNT(DISTINCT website_sessions.website_session_id) AS session_to_order_conversion_rate,
       ROUND(SUM(price_usd)/COUNT(DISTINCT orders.order_id), 2)                            AS revenue_per_order,
       ROUND(SUM(price_usd)/COUNT(DISTINCT website_sessions.website_session_id), 2)        AS revenue_per_session
FROM website_sessions
     LEFT JOIN orders
        ON website_sessions.website_session_id = orders.website_session_id
GROUP BY 1,2
ORDER BY 1,2




/*
   3. 
*/


/*
   4. 
*/
