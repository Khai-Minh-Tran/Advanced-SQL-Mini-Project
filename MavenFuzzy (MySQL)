SELECT website_sessions.utm_content,
	     count(DISTINCT website_sessions.website_session_id) AS sessions,
       count(DISTINCT orders.order_id) AS orders,
       count(DISTINCT orders.order_id)/count(DISTINCT website_sessions.website_session_id) AS session_to_order_conv_rt
FROM website_sessions
    LEFT JOIN orders
       ON orders.website_session_id = website_sessions.website_session_id
WHERE website_sessions.website_session_id BETWEEN 1000 AND 2000
GROUP BY 1
ORDER BY 2 DESC;

-----

SELECT utm_source,
	     utm_campaign,
       http_referer,
       COUNT(DISTINCT website_session_id) as num_sessions
FROM website_sessions
WHERE created_at < '2012-04-12'
GROUP BY utm_source, utm_campaign, http_referer
ORDER BY num_sessions DESC;

------

